var Todo={dumbTasks:[{todaysDate:"2016-10-20",dueDate:"2016-10-22",heading:"Tvätta (Task 1)",task:"Tvätta allt vitt ikväll!",priority:1},{todaysDate:"2016-10-20",dueDate:"2016-10-22",heading:"Skura (Task 2)",task:"Skura badrummet!",priority:3},{todaysDate:"2016-10-20",dueDate:"2016-10-22",heading:"Hämta på dagis (Task 2)",task:"Hämta lillen på dagis kl 16",priority:3}],init:function(){this.checkDB(),this.cacheDom(),this.bindEvents(),this.initDatesInForm(),this.makeTasksDraggable()},checkDB:function(){var t=localStorage.getItem("todoList");null==t?this.tasks=[]:this.tasks=JSON.parse(t)},initDatesInForm:function(){this.$formTodaysDate.val($.datepicker.formatDate("yy-mm-dd",new Date)).attr("disabled","true"),this.$formDueDate.datepicker({dateFormat:"yy-mm-dd",firstDay:1,minDate:-1})},makeTasksDraggable:function(){this.$tasksUL.sortable({axis:"y",handle:".move-icon",classes:{"ui-sortable-helper":"moving-task"}})},cacheDom:function(){this.$form=$("#add-form"),this.$formAddButton=$("#add-button"),this.$formTodaysDate=$("#date"),this.$formDueDate=$("#due"),this.$formHeading=$("#heading"),this.$formDesc=$("#desc"),this.$formPrio=$("#prio"),this.$tasksUL=$("#tasks"),this.$editBtn=$("#edit-btn"),this.$editBtns=$(".edit-btns")},getFormValues:function(){var t={todaysDate:this.$formTodaysDate.val(),dueDate:this.$formDueDate.val(),heading:this.$formHeading.val(),desc:this.$formDesc.val(),priority:this.$formPrio.children(".active").find("input").data("prio")};return t},bindEvents:function(){this.$formAddButton.on("click",this.addTask),this.$editBtn.on("click",this.toggleEditMode),$(document).on("keydown",function(t){27===t.keyCode&&console.log(Todo.tasks)})},toggleEditMode:function(){var t=Todo;t.$editBtns.toggleClass("edit-mode")},addTask:function(t){t.preventDefault();var e=Todo;e.validateForm()&&e.pushToArray()},pushToArray:function(){var t=this.getFormValues();console.log(t),this.tasks.push(t)},updateDB:function(){localStorage.setItem("todoList",JSON.stringify(this.tasks))},validateForm:function(){var t=this.getFormValues(),e=/[0-9]{4}\-[0-9]{2}\-[0-9]{2}/,a=/[0-9]{4}\-[0-9]{2}\-[0-9]{2}/,s=/.{1,50}/,o,i=!0;if(t.todaysDate.match(e))this.$formTodaysDate.parent().removeClass("has-error").find(".help-block").remove();else{i=!1;var o="The date has to be in format YYYY-MM-DD";this.$formTodaysDate.parent().addClass("has-error").prepend('<span class="help-block">'+o+"</span>")}if(t.dueDate.match(a))this.$formDueDate.parent().removeClass("has-error").find(".help-block").remove();else{i=!1;var o="The date has to be in format YYYY-MM-DD";this.$formDueDate.parent().addClass("has-error").prepend('<span class="help-block">'+o+"</span>")}if(t.heading.match(s))this.$formHeading.parent().removeClass("has-error").find(".help-block").remove();else{i=!1;var o="The heading has to be 1-50 characters";this.$formHeading.parent().addClass("has-error").prepend('<span class="help-block">'+o+"</span>")}if(t.desc.length<=0||t.desc.length>200){i=!1;var o="The description has to be 1-200 characters";this.$formDesc.parent().addClass("has-error").prepend('<span class="help-block">'+o+"</span>")}else this.$formDesc.parent().removeClass("has-error").find(".help-block").remove();return i}};$(document).ready(function(){Todo.init()});